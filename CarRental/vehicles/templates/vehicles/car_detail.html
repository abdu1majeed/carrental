{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container mt-5 pt-5">
    <a href="{% url 'vehicles:car_list' %}" class="btn btn-outline-secondary mb-4">
        &rarr; العودة للقائمة
    </a>

    <div class="row bg-white shadow-sm rounded p-4">
        <div class="col-md-6 mb-4 mb-md-0">
            {% if car.image %}
                <img src="{{ car.image.url }}" class="img-fluid rounded w-100 shadow-sm" alt="{{ car.brand }}">
            {% else %}
                <div class="bg-light d-flex align-items-center justify-content-center rounded" style="height: 400px;">
                    <span class="text-muted">لا توجد صورة متوفرة</span>
                </div>
            {% endif %}
        </div>

        <div class="col-md-6">
            <!-- ✅ التعديل الجوهري هنا: استبدال car.name بـ car.brand و car.model_name -->
            <h1 class="display-5 fw-bold text-dark">
                {{ car.brand }} <span class="text-muted fs-4">({{ car.model_name }})</span>
            </h1>
            
            <p class="lead text-muted mt-2">{{ car.description }}</p>

            <div class="my-3">
                {% if car.is_available %}
                    <span class="badge bg-success fs-6">متاحة للإيجار</span>
                {% else %}
                    <span class="badge bg-danger fs-6">غير متاحة</span>
                {% endif %}
            </div>

            <h2 class="text-primary fw-bold mb-4">{{ car.daily_price }} <span class="fs-5 text-dark">ريال سعودي / يومياً</span></h2>

            <hr>

            <h5 class="mb-3">المواصفات:</h5>
            <div class="row g-3 mb-4">
                <div class="col-6">
                    <div class="p-3 border rounded bg-light">
                        <small class="text-muted d-block">ناقل الحركة</small>
                        <!-- تأكد أن الأسماء هنا تطابق الموديل الجديد -->
                        <strong>{{ car.get_transmission_display }}</strong>
                    </div>
                </div>
                <div class="col-6">
                    <div class="p-3 border rounded bg-light">
                        <small class="text-muted d-block">نوع الوقود</small>
                        <strong>{{ car.get_fuel_type_display }}</strong>
                    </div>
                </div>
                <div class="col-6">
                    <div class="p-3 border rounded bg-light">
                        <small class="text-muted d-block">اللون</small>
                        <strong>{{ car.color }}</strong>
                    </div>
                </div>
                <div class="col-6">
                    <div class="p-3 border rounded bg-light">
                        <small class="text-muted d-block">رقم اللوحة</small>
                        <strong>{{ car.plate_number }}</strong>
                    </div>
                </div>
            </div>

            {% if car.is_available %}
                <!-- تأكد أن هذا الرابط صحيح، إذا لم تنشئ تطبيق bookings بعد، ضعه # مؤقتاً -->
                <a href="{% url 'bookings:create_booking' car.id %}" class="btn btn-primary btn-lg w-100 py-3">
                    احجز هذه السيارة الآن
                </a>
            {% else %}
                <button class="btn btn-secondary btn-lg w-100 py-3" disabled>
                    السيارة غير متاحة للحجز حالياً
                </button>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}